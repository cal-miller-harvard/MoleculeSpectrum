<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>API Documentation · MoleculeSpectrum Documentation</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">MoleculeSpectrum Documentation</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">MoleculeSpectrum</a></li><li class="is-active"><a class="tocitem" href>API Documentation</a><ul class="internal"><li><a class="tocitem" href="#Contents"><span>Contents</span></a></li><li><a class="tocitem" href="#Molecular-Parameters"><span>Molecular Parameters</span></a></li><li><a class="tocitem" href="#Vectors-and-Tensors"><span>Vectors and Tensors</span></a></li><li><a class="tocitem" href="#States"><span>States</span></a></li><li><a class="tocitem" href="#Fields"><span>Fields</span></a></li><li><a class="tocitem" href="#Hamiltonians"><span>Hamiltonians</span></a></li><li><a class="tocitem" href="#Spectra-and-Analysis"><span>Spectra and Analysis</span></a></li><li><a class="tocitem" href="#Index"><span>Index</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>API Documentation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>API Documentation</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/cal-miller-harvard/MoleculeSpectrum/blob/master/docs/src/api.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="MoleculeSpectrum.jl-API-Documentation"><a class="docs-heading-anchor" href="#MoleculeSpectrum.jl-API-Documentation">MoleculeSpectrum.jl API Documentation</a><a id="MoleculeSpectrum.jl-API-Documentation-1"></a><a class="docs-heading-anchor-permalink" href="#MoleculeSpectrum.jl-API-Documentation" title="Permalink"></a></h1><h2 id="Contents"><a class="docs-heading-anchor" href="#Contents">Contents</a><a id="Contents-1"></a><a class="docs-heading-anchor-permalink" href="#Contents" title="Permalink"></a></h2><ul><li><a href="#MoleculeSpectrum.jl-API-Documentation">MoleculeSpectrum.jl API Documentation</a></li><li class="no-marker"><ul><li><a href="#Contents">Contents</a></li><li><a href="#Molecular-Parameters">Molecular Parameters</a></li><li class="no-marker"><ul><li><a href="#Molecular-Parameters-2">Molecular Parameters</a></li><li><a href="#Polarizability-Parameters">Polarizability Parameters</a></li><li><a href="#Zeeman-Parameters">Zeeman Parameters</a></li><li><a href="#Nuclear-Parameters">Nuclear Parameters</a></li></ul></li><li><a href="#Vectors-and-Tensors">Vectors and Tensors</a></li><li class="no-marker"><ul><li><a href="#Spherical-vectors">Spherical vectors</a></li><li><a href="#Unit-vectors">Unit vectors</a></li><li><a href="#Tensors">Tensors</a></li></ul></li><li><a href="#States">States</a></li><li class="no-marker"><ul><li><a href="#Types">Types</a></li><li><a href="#Functions">Functions</a></li></ul></li><li><a href="#Fields">Fields</a></li><li><a href="#Hamiltonians">Hamiltonians</a></li><li><a href="#Spectra-and-Analysis">Spectra and Analysis</a></li><li><a href="#Index">Index</a></li></ul></li></ul><h2 id="Molecular-Parameters"><a class="docs-heading-anchor" href="#Molecular-Parameters">Molecular Parameters</a><a id="Molecular-Parameters-1"></a><a class="docs-heading-anchor-permalink" href="#Molecular-Parameters" title="Permalink"></a></h2><h3 id="Molecular-Parameters-2"><a class="docs-heading-anchor" href="#Molecular-Parameters-2">Molecular Parameters</a><a class="docs-heading-anchor-permalink" href="#Molecular-Parameters-2" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-binding" id="MoleculeSpectrum.MolecularParameters" href="#MoleculeSpectrum.MolecularParameters"><code>MoleculeSpectrum.MolecularParameters</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">struct MolecularParameters
    &quot;Permanent dipole moment (Debye)&quot;
    dₚ::Float64
    &quot;Rotational constant (MHz)&quot;
    Bᵣ::Float64
    &quot;Nuclear angular momenta&quot;
    I::SVector{2,HalfInt}
    &quot;Zeeman parameters&quot;
    zeeman::ZeemanParameters
    &quot;Nuclear Parameters&quot;
    nuclear::NuclearParameters
    &quot;Molecular polarizability at the trapping wavelength&quot;
    α::Polarizability
end</code></pre><p>Contains the coupling constants for the molecular Hamiltonian and the nuclear angular momenta (needed to  construct the basis states).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cal-miller-harvard/MoleculeSpectrum/blob/44ca798f0adbcb4a054c0d68ee3c4700e075c78c/src/molecular_parameters.jl#L75-L96">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MoleculeSpectrum.KRb_Parameters_Neyenhuis" href="#MoleculeSpectrum.KRb_Parameters_Neyenhuis"><code>MoleculeSpectrum.KRb_Parameters_Neyenhuis</code></a> — <span class="docstring-category">Constant</span></header><section><div><pre><code class="language-julia hljs">KRb_Parameters_Neyenhuis = MolecularParameters(
    0.574,
    1113.9514,
    [HalfInt(4), HalfInt(3 / 2)],
    KRb_Zeeman,
    KRb_Nuclear_Neyenhuis,
    KRb_Polarizability,
)</code></pre><p><a href="#MoleculeSpectrum.MolecularParameters"><code>MolecularParameters</code></a> with experimental values from <a href="https://doi.org/10.1103/PhysRevLett.109.230403">Neyenhuis et al., PRL 109, 230403 (2012)</a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cal-miller-harvard/MoleculeSpectrum/blob/44ca798f0adbcb4a054c0d68ee3c4700e075c78c/src/molecular_parameters.jl#L138-L150">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MoleculeSpectrum.KRb_Parameters_Ospelkaus" href="#MoleculeSpectrum.KRb_Parameters_Ospelkaus"><code>MoleculeSpectrum.KRb_Parameters_Ospelkaus</code></a> — <span class="docstring-category">Constant</span></header><section><div><pre><code class="language-julia hljs">KRb_Parameters_Ospelkaus = MolecularParameters(
    0.574,
    1113.950,
    [HalfInt(4), HalfInt(3 / 2)],
    KRb_Zeeman,
    KRb_Nuclear_Ospelkaus,
    KRb_Polarizability,
)</code></pre><p><a href="#MoleculeSpectrum.MolecularParameters"><code>MolecularParameters</code></a> with experimental values from <a href="https://doi.org/10.1103/PhysRevLett.104.030402">Ospelkaus et al., PRL 104, 030402 (2010)</a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cal-miller-harvard/MoleculeSpectrum/blob/44ca798f0adbcb4a054c0d68ee3c4700e075c78c/src/molecular_parameters.jl#L158-L170">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MoleculeSpectrum.DEFAULT_MOLECULAR_PARAMETERS" href="#MoleculeSpectrum.DEFAULT_MOLECULAR_PARAMETERS"><code>MoleculeSpectrum.DEFAULT_MOLECULAR_PARAMETERS</code></a> — <span class="docstring-category">Constant</span></header><section><div><pre><code class="language-julia hljs">DEFAULT_MOLECULAR_PARAMETERS</code></pre><p>Default molecular parameters; alias for <a href="#MoleculeSpectrum.KRb_Parameters_Neyenhuis"><code>KRb_Parameters_Neyenhuis</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cal-miller-harvard/MoleculeSpectrum/blob/44ca798f0adbcb4a054c0d68ee3c4700e075c78c/src/molecular_parameters.jl#L178-L182">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MoleculeSpectrum.TOY_MOLECULE_PARAMETERS" href="#MoleculeSpectrum.TOY_MOLECULE_PARAMETERS"><code>MoleculeSpectrum.TOY_MOLECULE_PARAMETERS</code></a> — <span class="docstring-category">Constant</span></header><section><div><pre><code class="language-julia hljs">TOY_MOLECULE_PARAMETERS</code></pre><p>Toy model values with dipole = 1 D, no hyperfine structure, etc. Intended for testing.</p><p>Note that the formulas break down for <code>I = 0</code>, which is why we use <code>I = 1</code> here.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cal-miller-harvard/MoleculeSpectrum/blob/44ca798f0adbcb4a054c0d68ee3c4700e075c78c/src/molecular_parameters.jl#L185-L193">source</a></section></article><h3 id="Polarizability-Parameters"><a class="docs-heading-anchor" href="#Polarizability-Parameters">Polarizability Parameters</a><a id="Polarizability-Parameters-1"></a><a class="docs-heading-anchor-permalink" href="#Polarizability-Parameters" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-binding" id="MoleculeSpectrum.Polarizability" href="#MoleculeSpectrum.Polarizability"><code>MoleculeSpectrum.Polarizability</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">struct Polarizability
    &quot;Parallel ac polarizability (MHz / (W / cm^2))&quot;
    α_par::Float64
    &quot;Perpendicular ac polarizability (MHz / (W / cm^2))&quot;
    α_perp::Float64
end</code></pre><p>Contains the parallel and perpendicular ac polarizabilities at a particular optical wavelength λ.</p><p>So far, it is assumed that λ is far-detuned from any electronic transitions, such that the polarizability does not depend on rotational state <span>$N$</span>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cal-miller-harvard/MoleculeSpectrum/blob/44ca798f0adbcb4a054c0d68ee3c4700e075c78c/src/molecular_parameters.jl#L51-L67">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MoleculeSpectrum.KRb_Polarizability" href="#MoleculeSpectrum.KRb_Polarizability"><code>MoleculeSpectrum.KRb_Polarizability</code></a> — <span class="docstring-category">Constant</span></header><section><div><pre><code class="language-julia hljs">KRb_Polarizability = Polarizability(10.0e-5, 3.3e-5)</code></pre><p><a href="#MoleculeSpectrum.Polarizability"><code>Polarizability</code></a> with experimental values from <a href="https://doi.org/10.1103/PhysRevLett.109.230403">Neyenhuis et al., PRL 109, 230403 (2012)</a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cal-miller-harvard/MoleculeSpectrum/blob/44ca798f0adbcb4a054c0d68ee3c4700e075c78c/src/molecular_parameters.jl#L118-L123">source</a></section></article><h3 id="Zeeman-Parameters"><a class="docs-heading-anchor" href="#Zeeman-Parameters">Zeeman Parameters</a><a id="Zeeman-Parameters-1"></a><a class="docs-heading-anchor-permalink" href="#Zeeman-Parameters" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-binding" id="MoleculeSpectrum.ZeemanParameters" href="#MoleculeSpectrum.ZeemanParameters"><code>MoleculeSpectrum.ZeemanParameters</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">struct ZeemanParameters
    &quot;Rotational g factor&quot;
    gᵣ::Float64
    &quot;Nuclear g factor&quot;
    gᵢ::SVector{2,Float64}
    &quot;Nuclear shielding factor&quot;
    σᵢ::SVector{2,Float64}
end</code></pre><p>Contains the g-factors and nuclear shielding factors for computing Zeeman shifts.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cal-miller-harvard/MoleculeSpectrum/blob/44ca798f0adbcb4a054c0d68ee3c4700e075c78c/src/molecular_parameters.jl#L1-L15">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MoleculeSpectrum.KRb_Zeeman" href="#MoleculeSpectrum.KRb_Zeeman"><code>MoleculeSpectrum.KRb_Zeeman</code></a> — <span class="docstring-category">Constant</span></header><section><div><pre><code class="language-julia hljs">KRb_Zeeman = ZeemanParameters(0.014, [-0.324, 1.834], [1321e-6, 3469e-6])</code></pre><p><a href="#MoleculeSpectrum.ZeemanParameters"><code>ZeemanParameters</code></a> with theoretical values from <a href="https://doi.org/10.1103/PhysRevA.78.033434">Aldegunde et al., PRA 78, 033434 (2008)</a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cal-miller-harvard/MoleculeSpectrum/blob/44ca798f0adbcb4a054c0d68ee3c4700e075c78c/src/molecular_parameters.jl#L112-L117">source</a></section></article><h3 id="Nuclear-Parameters"><a class="docs-heading-anchor" href="#Nuclear-Parameters">Nuclear Parameters</a><a id="Nuclear-Parameters-1"></a><a class="docs-heading-anchor-permalink" href="#Nuclear-Parameters" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-binding" id="MoleculeSpectrum.NuclearParameters" href="#MoleculeSpectrum.NuclearParameters"><code>MoleculeSpectrum.NuclearParameters</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">struct NuclearParameters
    &quot;Nuclear electric quadrupole (MHz)&quot;
    eqQᵢ::SVector{2,Float64}
    &quot;Nuclear spin-rotation interaction (MHz)&quot;
    cᵢ::SVector{2,Float64}
    &quot;Nuclear spin-spin scalar interaction (MHz)&quot;
    c₄::Float64
end</code></pre><p>Contains the nuclear electric quadrupole moments, nuclear spin-rotation couplings, and nuclear spin-spin coupling for calculating the hyperfine Hamiltonian.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cal-miller-harvard/MoleculeSpectrum/blob/44ca798f0adbcb4a054c0d68ee3c4700e075c78c/src/molecular_parameters.jl#L25-L41">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MoleculeSpectrum.KRb_Nuclear_Neyenhuis" href="#MoleculeSpectrum.KRb_Nuclear_Neyenhuis"><code>MoleculeSpectrum.KRb_Nuclear_Neyenhuis</code></a> — <span class="docstring-category">Constant</span></header><section><div><pre><code class="language-julia hljs">KRb_Nuclear_Neyenhuis = NuclearParameters([0.45, -1.308], [-24.1e-6, 420.1e-6], -2030.4e-6)</code></pre><p><a href="#MoleculeSpectrum.NuclearParameters"><code>NuclearParameters</code></a> with experimental values from <a href="https://doi.org/10.1103/PhysRevLett.109.230403">Neyenhuis et al., PRL 109, 230403 (2012)</a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cal-miller-harvard/MoleculeSpectrum/blob/44ca798f0adbcb4a054c0d68ee3c4700e075c78c/src/molecular_parameters.jl#L124-L129">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MoleculeSpectrum.KRb_Nuclear_Ospelkaus" href="#MoleculeSpectrum.KRb_Nuclear_Ospelkaus"><code>MoleculeSpectrum.KRb_Nuclear_Ospelkaus</code></a> — <span class="docstring-category">Constant</span></header><section><div><pre><code class="language-julia hljs">KRb_Nuclear_Ospelkaus = NuclearParameters([0.45, -1.41], [-24.1e-6, 420.1e-6], -2030.4e-6)</code></pre><p><a href="#MoleculeSpectrum.NuclearParameters"><code>NuclearParameters</code></a> with experimental values from <a href="https://doi.org/10.1103/PhysRevLett.104.030402">Ospelkaus et al., PRL 104, 030402 (2010)</a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cal-miller-harvard/MoleculeSpectrum/blob/44ca798f0adbcb4a054c0d68ee3c4700e075c78c/src/molecular_parameters.jl#L131-L136">source</a></section></article><h2 id="Vectors-and-Tensors"><a class="docs-heading-anchor" href="#Vectors-and-Tensors">Vectors and Tensors</a><a id="Vectors-and-Tensors-1"></a><a class="docs-heading-anchor-permalink" href="#Vectors-and-Tensors" title="Permalink"></a></h2><h3 id="Spherical-vectors"><a class="docs-heading-anchor" href="#Spherical-vectors">Spherical vectors</a><a id="Spherical-vectors-1"></a><a class="docs-heading-anchor-permalink" href="#Spherical-vectors" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-binding" id="MoleculeSpectrum.SphericalVector" href="#MoleculeSpectrum.SphericalVector"><code>MoleculeSpectrum.SphericalVector</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">SphericalVector(magnitude, θ, φ)</code></pre><p>Construct a vector with <code>magnitude</code>, polar angle <code>θ</code>, and azimuthal angle <code>φ</code>.</p><p>Represents an external field vector in spherical coordinates used to construct <a href="#MoleculeSpectrum.ExternalFields"><code>ExternalFields</code></a>. Currently, <code>SphericalVector</code>s may be negated but no other mathematical operations are implemented.</p><p>Vectors along <span>$x$</span>, <span>$y$</span>, or <span>$z$</span> can be quickly constructed using <a href="#MoleculeSpectrum.VectorX"><code>VectorX</code></a>, <a href="#MoleculeSpectrum.VectorY"><code>VectorY</code></a>, and <a href="#MoleculeSpectrum.VectorZ"><code>VectorZ</code></a>, respectively.</p><p>See also <a href="#MoleculeSpectrum.SphericalUnitVector"><code>SphericalUnitVector</code></a>, <a href="#MoleculeSpectrum.ExternalFields"><code>ExternalFields</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cal-miller-harvard/MoleculeSpectrum/blob/44ca798f0adbcb4a054c0d68ee3c4700e075c78c/src/fields.jl#L1-L15">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MoleculeSpectrum.VectorX" href="#MoleculeSpectrum.VectorX"><code>MoleculeSpectrum.VectorX</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">VectorX(magnitude)</code></pre><p>Construct a <a href="#MoleculeSpectrum.SphericalVector"><code>SphericalVector</code></a> with <code>magnitude</code> along <code>x</code>.</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; VectorX(5.0)
SphericalVector(5.0, 1.5707963267948966, 0.0)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cal-miller-harvard/MoleculeSpectrum/blob/44ca798f0adbcb4a054c0d68ee3c4700e075c78c/src/fields.jl#L47-L57">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MoleculeSpectrum.VectorY" href="#MoleculeSpectrum.VectorY"><code>MoleculeSpectrum.VectorY</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">VectorY(magnitude)</code></pre><p>Construct a <a href="#MoleculeSpectrum.SphericalVector"><code>SphericalVector</code></a> with <code>magnitude</code> along <code>y</code>.</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; VectorY(2.0)
SphericalVector(2.0, 1.5707963267948966, 1.5707963267948966)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cal-miller-harvard/MoleculeSpectrum/blob/44ca798f0adbcb4a054c0d68ee3c4700e075c78c/src/fields.jl#L60-L70">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MoleculeSpectrum.VectorZ" href="#MoleculeSpectrum.VectorZ"><code>MoleculeSpectrum.VectorZ</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">VectorZ(magnitude)</code></pre><p>Construct a <a href="#MoleculeSpectrum.SphericalVector"><code>SphericalVector</code></a> with <code>magnitude</code> along <code>z</code>.</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; VectorZ(10.0)
SphericalVector(10.0, 0.0, 0.0)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cal-miller-harvard/MoleculeSpectrum/blob/44ca798f0adbcb4a054c0d68ee3c4700e075c78c/src/fields.jl#L73-L83">source</a></section></article><h3 id="Unit-vectors"><a class="docs-heading-anchor" href="#Unit-vectors">Unit vectors</a><a id="Unit-vectors-1"></a><a class="docs-heading-anchor-permalink" href="#Unit-vectors" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-binding" id="MoleculeSpectrum.SphericalUnitVector" href="#MoleculeSpectrum.SphericalUnitVector"><code>MoleculeSpectrum.SphericalUnitVector</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">SphericalUnitVector(magnitude, θ, φ)
SphericalUnitVector(v::SphericalVector)</code></pre><p>Construct a unit vector with polar angle <code>θ</code>, and azimuthal angle <code>φ</code>.</p><p>Represents the direction of an external field vector in spherical coordinates. Currently, <code>SphericalUnitVector</code>s may be negated but no other mathematical operations are implemented.</p><p>Vectors along <span>$x$</span>, <span>$y$</span>, or <span>$z$</span> can be quickly constructed using <a href="#MoleculeSpectrum.UnitVectorX"><code>UnitVectorX</code></a>, <a href="#MoleculeSpectrum.UnitVectorY"><code>UnitVectorY</code></a>, and <a href="#MoleculeSpectrum.UnitVectorZ"><code>UnitVectorZ</code></a>, respectively.</p><p>See also <a href="#MoleculeSpectrum.SphericalVector"><code>SphericalVector</code></a>, <a href="#MoleculeSpectrum.find_transition_strengths"><code>find_transition_strengths</code></a>, <a href="#MoleculeSpectrum.T⁽¹⁾"><code>T⁽¹⁾</code></a>, <a href="#MoleculeSpectrum.T⁽²⁾"><code>T⁽²⁾</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cal-miller-harvard/MoleculeSpectrum/blob/44ca798f0adbcb4a054c0d68ee3c4700e075c78c/src/fields.jl#L86-L102">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MoleculeSpectrum.UnitVectorX" href="#MoleculeSpectrum.UnitVectorX"><code>MoleculeSpectrum.UnitVectorX</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">UnitVectorX()</code></pre><p>Construct a <a href="#MoleculeSpectrum.SphericalUnitVector"><code>SphericalUnitVector</code></a> along <code>x</code>.</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; UnitVectorX()
SphericalUnitVector(1.5707963267948966, 0.0)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cal-miller-harvard/MoleculeSpectrum/blob/44ca798f0adbcb4a054c0d68ee3c4700e075c78c/src/fields.jl#L126-L136">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MoleculeSpectrum.UnitVectorY" href="#MoleculeSpectrum.UnitVectorY"><code>MoleculeSpectrum.UnitVectorY</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">UnitVectorY()</code></pre><p>Construct a <a href="#MoleculeSpectrum.SphericalUnitVector"><code>SphericalUnitVector</code></a> along <code>y</code>.</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; UnitVectorY()
SphericalUnitVector(1.5707963267948966, 1.5707963267948966)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cal-miller-harvard/MoleculeSpectrum/blob/44ca798f0adbcb4a054c0d68ee3c4700e075c78c/src/fields.jl#L139-L149">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MoleculeSpectrum.UnitVectorZ" href="#MoleculeSpectrum.UnitVectorZ"><code>MoleculeSpectrum.UnitVectorZ</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">UnitVectorZ()</code></pre><p>Construct a <a href="#MoleculeSpectrum.SphericalUnitVector"><code>SphericalUnitVector</code></a> along <code>z</code>.</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; UnitVectorZ()
SphericalUnitVector(0.0, 0.0)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cal-miller-harvard/MoleculeSpectrum/blob/44ca798f0adbcb4a054c0d68ee3c4700e075c78c/src/fields.jl#L152-L162">source</a></section></article><h3 id="Tensors"><a class="docs-heading-anchor" href="#Tensors">Tensors</a><a id="Tensors-1"></a><a class="docs-heading-anchor-permalink" href="#Tensors" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-binding" id="MoleculeSpectrum.T⁽¹⁾" href="#MoleculeSpectrum.T⁽¹⁾"><code>MoleculeSpectrum.T⁽¹⁾</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">T⁽¹⁾(v)</code></pre><p>Construct the components of the rank 1 spherical tensor <span>$T⁽¹⁾(v)$</span>.</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; T⁽¹⁾(UnitVectorX())
3-element StaticArrays.SVector{3, ComplexF64} with indices SOneTo(3):
    0.7071067811865475 - 0.0im
 6.123233995736766e-17 + 0.0im
   -0.7071067811865475 - 0.0im</code></pre><pre><code class="language-julia-repl hljs">julia&gt; T⁽¹⁾(UnitVectorY())
3-element StaticArrays.SVector{3, ComplexF64} with indices SOneTo(3):
  4.329780281177466e-17 - 0.7071067811865475im
  6.123233995736766e-17 + 0.0im
 -4.329780281177466e-17 - 0.7071067811865475im</code></pre><pre><code class="language-julia-repl hljs">julia&gt; T⁽¹⁾(UnitVectorZ())
3-element StaticArrays.SVector{3, ComplexF64} with indices SOneTo(3):
  0.0 - 0.0im
  1.0 + 0.0im
 -0.0 - 0.0im</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cal-miller-harvard/MoleculeSpectrum/blob/44ca798f0adbcb4a054c0d68ee3c4700e075c78c/src/fields.jl#L165-L194">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MoleculeSpectrum.T⁽²⁾" href="#MoleculeSpectrum.T⁽²⁾"><code>MoleculeSpectrum.T⁽²⁾</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">T⁽²⁾(v)</code></pre><p>Construct the components of the rank 2 spherical tensor <span>$T⁽²⁾(v, v)$</span>.</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; T⁽²⁾(UnitVectorX())
5-element StaticArrays.SVector{5, ComplexF64} with indices SOneTo(5):
                    0.5 - 0.0im
  6.123233995736766e-17 - 0.0im
    -0.4082482904638631 + 0.0im
 -6.123233995736766e-17 - 0.0im
                    0.5 + 0.0im</code></pre><pre><code class="language-julia-repl hljs">julia&gt; T⁽²⁾(UnitVectorY())
5-element StaticArrays.SVector{5, ComplexF64} with indices SOneTo(5):
                   -0.5 - 6.123233995736766e-17im
  3.749399456654644e-33 - 6.123233995736766e-17im
    -0.4082482904638631 + 0.0im
 -3.749399456654644e-33 - 6.123233995736766e-17im
                   -0.5 + 6.123233995736766e-17im</code></pre><pre><code class="language-julia-repl hljs">julia&gt; T⁽²⁾(UnitVectorZ())
5-element StaticArrays.SVector{5, ComplexF64} with indices SOneTo(5):
                0.0 - 0.0im
                0.0 - 0.0im
 0.8164965809277261 + 0.0im
               -0.0 - 0.0im
                0.0 + 0.0im</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cal-miller-harvard/MoleculeSpectrum/blob/44ca798f0adbcb4a054c0d68ee3c4700e075c78c/src/fields.jl#L209-L244">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MoleculeSpectrum.get_tensor_component" href="#MoleculeSpectrum.get_tensor_component"><code>MoleculeSpectrum.get_tensor_component</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">get_tensor_component(p::Int, tensor)</code></pre><p>#TODO: Document what <code>get_tensor_component</code> does.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cal-miller-harvard/MoleculeSpectrum/blob/44ca798f0adbcb4a054c0d68ee3c4700e075c78c/src/fields.jl#L272-L276">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MoleculeSpectrum.tensor_dot" href="#MoleculeSpectrum.tensor_dot"><code>MoleculeSpectrum.tensor_dot</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">tensor_dot(a, b)</code></pre><p>Contract two spherical tensors <code>a</code> and <code>b</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cal-miller-harvard/MoleculeSpectrum/blob/44ca798f0adbcb4a054c0d68ee3c4700e075c78c/src/fields.jl#L282-L286">source</a></section></article><h2 id="States"><a class="docs-heading-anchor" href="#States">States</a><a id="States-1"></a><a class="docs-heading-anchor-permalink" href="#States" title="Permalink"></a></h2><h3 id="Types"><a class="docs-heading-anchor" href="#Types">Types</a><a id="Types-1"></a><a class="docs-heading-anchor-permalink" href="#Types" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-binding" id="MoleculeSpectrum.State" href="#MoleculeSpectrum.State"><code>MoleculeSpectrum.State</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">struct State
    N::Int
    mₙ::Int
    I::SVector{2,HalfInt}
    mᵢ::SVector{2,HalfInt}
end</code></pre><p>Represents a molecular state in the uncoupled basis.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cal-miller-harvard/MoleculeSpectrum/blob/44ca798f0adbcb4a054c0d68ee3c4700e075c78c/src/MoleculeSpectrum.jl#L42-L53">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MoleculeSpectrum.KRbState" href="#MoleculeSpectrum.KRbState"><code>MoleculeSpectrum.KRbState</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">KRbState(N, mₙ, mK, mRb)</code></pre><p>Creates a basis state <span>$|N, m_n, m_{\text{K}}, m_{\text{Rb}}⟩$</span> for <span>${}^{40}\text{K}^{87}\text{Rb}$</span>.</p><p>This is a wrapper around <a href="#MoleculeSpectrum.State"><code>State</code></a> to avoid having to specify the nuclear spins <span>$I_k$</span> each time.</p><p>See also <a href="#MoleculeSpectrum.State"><code>State</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cal-miller-harvard/MoleculeSpectrum/blob/44ca798f0adbcb4a054c0d68ee3c4700e075c78c/src/MoleculeSpectrum.jl#L69-L77">source</a></section></article><h3 id="Functions"><a class="docs-heading-anchor" href="#Functions">Functions</a><a id="Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Functions" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-binding" id="MoleculeSpectrum.index_to_state" href="#MoleculeSpectrum.index_to_state"><code>MoleculeSpectrum.index_to_state</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">index_to_state(i, I₁, I₂)</code></pre><p>Returns the <code>State</code> corresponding to the <code>i</code>th member of the basis.</p><p>The uncoupled basis <span>$|N, mₙ, I₁, mᵢ₁, I₂, mᵢ₂⟩$</span> is ordered with the quantum numbers on the left changing the slowest.</p><p>See also <a href="#MoleculeSpectrum.State"><code>State</code></a>, <a href="#MoleculeSpectrum.state_to_index"><code>state_to_index</code></a>.</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; s = index_to_state(1, 4, 3/2)
State(0, 0, HalfIntegers.Half{Int64}[4, 3/2], HalfIntegers.Half{Int64}[-4, -3/2])</code></pre><pre><code class="language-julia-repl hljs">julia&gt; s = index_to_state(37, 4, 3/2)
State(1, -1, HalfIntegers.Half{Int64}[4, 3/2], HalfIntegers.Half{Int64}[-4, -3/2])</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cal-miller-harvard/MoleculeSpectrum/blob/44ca798f0adbcb4a054c0d68ee3c4700e075c78c/src/utility.jl#L4-L24">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MoleculeSpectrum.state_to_index" href="#MoleculeSpectrum.state_to_index"><code>MoleculeSpectrum.state_to_index</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">state_to_index(s::State)</code></pre><p>Returns index of state <code>s</code> in the basis.</p><p>The uncoupled basis <span>$|N, mₙ, I₁, mᵢ₁, I₂, mᵢ₂⟩$</span> is ordered with the quantum numbers on the left changing the slowest.</p><p>See also <a href="#MoleculeSpectrum.State"><code>State</code></a>, <a href="#MoleculeSpectrum.index_to_state"><code>index_to_state</code></a>.</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; state_to_index(KRbState(1, 1, -4, 1/2))
111</code></pre><pre><code class="language-julia-repl hljs">julia&gt; state_to_index(index_to_state(42, 4, 3/2))
42</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cal-miller-harvard/MoleculeSpectrum/blob/44ca798f0adbcb4a054c0d68ee3c4700e075c78c/src/utility.jl#L40-L60">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MoleculeSpectrum.order_by_overlap_with" href="#MoleculeSpectrum.order_by_overlap_with"><code>MoleculeSpectrum.order_by_overlap_with</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">order_by_overlap_with(spectrum, target)</code></pre><p>Orders the list of eigenstates from <code>spectrum</code> by their wavefunction overlap with <code>target</code>.</p><p>See also <a href="#MoleculeSpectrum.calculate_spectrum"><code>calculate_spectrum</code></a>, <a href="#MoleculeSpectrum.max_overlap_with"><code>max_overlap_with</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cal-miller-harvard/MoleculeSpectrum/blob/44ca798f0adbcb4a054c0d68ee3c4700e075c78c/src/utility.jl#L69-L76">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MoleculeSpectrum.max_overlap_with" href="#MoleculeSpectrum.max_overlap_with"><code>MoleculeSpectrum.max_overlap_with</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">max_overlap_with(spectrum, target)</code></pre><p>Find the eigenstate from <code>spectrum</code> with the most wavefunction overlap with <code>target</code>.</p><p>Returns a tuple <code>(overlap, index)</code>, where <code>overlap</code> is the wavefunction overlap with <code>target</code> and <code>index</code> is the position of the eigenstates in <code>spectrum</code>.</p><p>See also <a href="#MoleculeSpectrum.calculate_spectrum"><code>calculate_spectrum</code></a>, <a href="#MoleculeSpectrum.order_by_overlap_with"><code>order_by_overlap_with</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cal-miller-harvard/MoleculeSpectrum/blob/44ca798f0adbcb4a054c0d68ee3c4700e075c78c/src/utility.jl#L87-L96">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MoleculeSpectrum.find_closest_basis_state" href="#MoleculeSpectrum.find_closest_basis_state"><code>MoleculeSpectrum.find_closest_basis_state</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">find_closest_basis_state(spectrum, index)</code></pre><p>Find the basis state with the most wavefunction overlap with the eigenstate from <code>spectrum</code> at <code>index</code>.</p><p>This method can be thought of as an inverse to <a href="#MoleculeSpectrum.max_overlap_with"><code>max_overlap_with</code></a>. </p><p>See also <a href="#MoleculeSpectrum.calculate_spectrum"><code>calculate_spectrum</code></a>, <a href="#MoleculeSpectrum.max_overlap_with"><code>max_overlap_with</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cal-miller-harvard/MoleculeSpectrum/blob/44ca798f0adbcb4a054c0d68ee3c4700e075c78c/src/utility.jl#L105-L113">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MoleculeSpectrum.decompose_to_basis_states" href="#MoleculeSpectrum.decompose_to_basis_states"><code>MoleculeSpectrum.decompose_to_basis_states</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">decompose_to_basis_states(spectrum::Spectrum, index::Int)
decompose_to_basis_states(spectrum::Spectrum, state::Vector{ComplexF64})
decompose_to_basis_states(state::Vector{ComplexF64}, I1, I2)</code></pre><p>Decompose the given <code>state</code> into basis states in order of decreasing weight.</p><p>Outputs a <code>Vector{Tuple{State, Float64}}</code>, giving a list <code>[(basis_state, weight)]</code>. The first variant provides the decomposition of the member of <code>spectrum.eigenstates</code> at position <code>index</code>. The second and third variants provide the decomposition of the vector <code>state</code>. The third variant does not require <code>spectrum</code> and recomputes the basis set according to <code>I1</code> and <code>I2</code>.</p><p>See also <a href="#MoleculeSpectrum.calculate_spectrum"><code>calculate_spectrum</code></a>, <a href="#MoleculeSpectrum.max_overlap_with"><code>max_overlap_with</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cal-miller-harvard/MoleculeSpectrum/blob/44ca798f0adbcb4a054c0d68ee3c4700e075c78c/src/utility.jl#L127-L140">source</a></section></article><h2 id="Fields"><a class="docs-heading-anchor" href="#Fields">Fields</a><a id="Fields-1"></a><a class="docs-heading-anchor-permalink" href="#Fields" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="MoleculeSpectrum.ExternalFields" href="#MoleculeSpectrum.ExternalFields"><code>MoleculeSpectrum.ExternalFields</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">ExternalFields(B::SphericalVector, E::SphericalVector, Optical::Vector{SphericalVector})
ExternalFields(B::Float64, E::Float64)</code></pre><p>External magnetic, electric, optical fields to use in constructing the Hamiltonian.</p><p>If <code>B</code> and <code>E</code> are provided as <code>Float64</code>s, then the fields are assumed to be along <code>z</code>. The <code>Optical</code> argument can also be left as an empty vector <code>[]</code>.</p><p>See also <a href="#MoleculeSpectrum.calculate_spectrum"><code>calculate_spectrum</code></a>, <a href="#MoleculeSpectrum.hamiltonian"><code>hamiltonian</code></a>, <a href="#MoleculeSpectrum.SphericalVector"><code>SphericalVector</code></a>.</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; ExternalFields(VectorZ(545.9), VectorX(1020.0), [])
ExternalFields(SphericalVector(545.9, 0.0, 0.0), SphericalVector(1020.0, 1.5707963267948966, 0.0), SphericalVector[])</code></pre><pre><code class="language-julia-repl hljs">julia&gt; ExternalFields(545.9, 1020.0)
ExternalFields(SphericalVector(545.9, 0.0, 0.0), SphericalVector(1020.0, 0.0, 0.0), SphericalVector[])</code></pre><pre><code class="language-julia-repl hljs">julia&gt; ExternalFields(VectorZ(545.9), VectorX(1020.0), [VectorY(2300.), SphericalVector(2300., π/2, π/4)])
ExternalFields(SphericalVector(545.9, 0.0, 0.0), SphericalVector(1020.0, 1.5707963267948966, 0.0), SphericalVector[SphericalVector(2300.0, 1.5707963267948966, 1.5707963267948966), SphericalVector(2300.0, 1.5707963267948966, 0.7853981633974483)])</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cal-miller-harvard/MoleculeSpectrum/blob/44ca798f0adbcb4a054c0d68ee3c4700e075c78c/src/fields.jl#L294-L320">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MoleculeSpectrum.DEFAULT_FIELDS" href="#MoleculeSpectrum.DEFAULT_FIELDS"><code>MoleculeSpectrum.DEFAULT_FIELDS</code></a> — <span class="docstring-category">Constant</span></header><section><div><pre><code class="language-julia hljs">DEFAULT_FIELDS = ExternalFields(545.9, 0.0)</code></pre><p>Defines an <a href="#MoleculeSpectrum.ExternalFields"><code>ExternalFields</code></a> with a magnetic field of 545.9 G along the <code>z</code> axis.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cal-miller-harvard/MoleculeSpectrum/blob/44ca798f0adbcb4a054c0d68ee3c4700e075c78c/src/fields.jl#L338-L342">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MoleculeSpectrum.TEST_FIELDS" href="#MoleculeSpectrum.TEST_FIELDS"><code>MoleculeSpectrum.TEST_FIELDS</code></a> — <span class="docstring-category">Constant</span></header><section><div><pre><code class="language-julia hljs">TEST_FIELDS = ExternalFields(
    SphericalVector(545.9, π / 4, π / 4),
    SphericalVector(1000.0, 3π / 4, 7π / 4),
    [SphericalVector(2350.0, 0.0, 0.0)],
)</code></pre><p>Defines an <a href="#MoleculeSpectrum.ExternalFields"><code>ExternalFields</code></a> with a magnetic, electric, and optical fields for tests.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cal-miller-harvard/MoleculeSpectrum/blob/44ca798f0adbcb4a054c0d68ee3c4700e075c78c/src/fields.jl#L345-L353">source</a></section></article><h2 id="Hamiltonians"><a class="docs-heading-anchor" href="#Hamiltonians">Hamiltonians</a><a id="Hamiltonians-1"></a><a class="docs-heading-anchor-permalink" href="#Hamiltonians" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="MoleculeSpectrum.hamiltonian" href="#MoleculeSpectrum.hamiltonian"><code>MoleculeSpectrum.hamiltonian</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">hamiltonian(parts, external_fields)</code></pre><p>Construct the full Hamiltonian including magnetic, electric, and optical fields.</p><p>Returns a dense Hermitian matrix.</p><p>The field-independent building blocks in <code>parts</code> can be reused over calls to <code>hamiltonian</code> to avoid recalculating the matrix elements each time.</p><p>See also <a href="#MoleculeSpectrum.make_hamiltonian_parts"><code>make_hamiltonian_parts</code></a>, <a href="#MoleculeSpectrum.make_krb_hamiltonian_parts"><code>make_krb_hamiltonian_parts</code></a>, <a href="#MoleculeSpectrum.ExternalFields"><code>ExternalFields</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cal-miller-harvard/MoleculeSpectrum/blob/44ca798f0adbcb4a054c0d68ee3c4700e075c78c/src/hamiltonian.jl#L226-L238">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MoleculeSpectrum.HamiltonianParts" href="#MoleculeSpectrum.HamiltonianParts"><code>MoleculeSpectrum.HamiltonianParts</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">struct HamiltonianParts
    basis::Vector{State}
    rotation::SparseHamiltonian
    dipole::SVector{3, SparseHamiltonian}
    dipole_relative::SVector{3, SparseHamiltonian} # used for transition strengths
    hyperfine::SparseHamiltonian
    zeeman::SVector{3, SparseHamiltonian}
    ac_scalar::SparseHamiltonian
    ac_tensor::SVector{5, SparseHamiltonian}
end</code></pre><p>Contains all parts of the Hamiltonian except external fields.</p><p>Zeeman, dc Stark, and ac Stark terms are stored as vectors of matrices that can be contracted with the appropriate external field tensors. This allows the full Hamiltonian to be re-constructed at various field values and orientations without recalculating all of the matrix elements.</p><p>Should be created by <a href="#MoleculeSpectrum.make_hamiltonian_parts"><code>make_hamiltonian_parts</code></a> or <a href="#MoleculeSpectrum.make_krb_hamiltonian_parts"><code>make_krb_hamiltonian_parts</code></a>. Used as an input to <a href="#MoleculeSpectrum.calculate_spectrum"><code>calculate_spectrum</code></a> and <a href="#MoleculeSpectrum.hamiltonian"><code>hamiltonian</code></a>.</p><p>See also <a href="#MoleculeSpectrum.make_hamiltonian_parts"><code>make_hamiltonian_parts</code></a>, <a href="#MoleculeSpectrum.make_krb_hamiltonian_parts"><code>make_krb_hamiltonian_parts</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cal-miller-harvard/MoleculeSpectrum/blob/44ca798f0adbcb4a054c0d68ee3c4700e075c78c/src/hamiltonian.jl#L130-L155">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MoleculeSpectrum.make_hamiltonian_parts" href="#MoleculeSpectrum.make_hamiltonian_parts"><code>MoleculeSpectrum.make_hamiltonian_parts</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">make_hamiltonian_parts(molecular_parameters, N_max)</code></pre><p>Construct all parts of the Hamiltonian that do not depend on external fields.</p><p>The size of the basis is determined by <code>molecular_parameters</code>, which contains the nuclear spin quantum numbers <code>molecular_parameters.I</code>, and the rotational states <code>0:N_max</code> to include.</p><p>See also <a href="#MoleculeSpectrum.make_krb_hamiltonian_parts"><code>make_krb_hamiltonian_parts</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cal-miller-harvard/MoleculeSpectrum/blob/44ca798f0adbcb4a054c0d68ee3c4700e075c78c/src/hamiltonian.jl#L175-L185">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MoleculeSpectrum.make_krb_hamiltonian_parts" href="#MoleculeSpectrum.make_krb_hamiltonian_parts"><code>MoleculeSpectrum.make_krb_hamiltonian_parts</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">make_krb_hamiltonian_parts(N_max)</code></pre><p>Construct all parts of the <span>${}^{40}\text{K}^{87}\text{Rb}$</span> Hamiltonian that do not depend on external fields.</p><p>The rotational states <code>0:N_max</code> are included. This is a shortcut method that replaces <code>make_hamiltonian_parts</code> for KRb.</p><p>See also <a href="#MoleculeSpectrum.make_hamiltonian_parts"><code>make_hamiltonian_parts</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cal-miller-harvard/MoleculeSpectrum/blob/44ca798f0adbcb4a054c0d68ee3c4700e075c78c/src/hamiltonian.jl#L211-L221">source</a></section></article><h2 id="Spectra-and-Analysis"><a class="docs-heading-anchor" href="#Spectra-and-Analysis">Spectra and Analysis</a><a id="Spectra-and-Analysis-1"></a><a class="docs-heading-anchor-permalink" href="#Spectra-and-Analysis" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="MoleculeSpectrum.Spectrum" href="#MoleculeSpectrum.Spectrum"><code>MoleculeSpectrum.Spectrum</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">Spectrum(hamiltonian_parts, energies, eigenstates)</code></pre><p>Represents a molecular spectrum, including eigenvalues and eigenstates, given <a href="#MoleculeSpectrum.HamiltonianParts"><code>HamiltonianParts</code></a> and <a href="#MoleculeSpectrum.ExternalFields"><code>ExternalFields</code></a>.</p><p>Created from <a href="#MoleculeSpectrum.calculate_spectrum"><code>calculate_spectrum</code></a>. See <a href="#MoleculeSpectrum.decompose_to_basis_states"><code>decompose_to_basis_states</code></a> and <a href="#MoleculeSpectrum.get_energy"><code>get_energy</code></a>for access to eigenstates and energies.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cal-miller-harvard/MoleculeSpectrum/blob/44ca798f0adbcb4a054c0d68ee3c4700e075c78c/src/MoleculeSpectrum.jl#L84-L92">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MoleculeSpectrum.calculate_spectrum" href="#MoleculeSpectrum.calculate_spectrum"><code>MoleculeSpectrum.calculate_spectrum</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">calculate_spectrum(hamiltonian_parts, external_fields)</code></pre><p>Compute the energies and eigenstates under the external fields.</p><p>To avoid reconstructing the Hamiltonian each time, <code>hamiltonian_parts</code> can be reused over calls to <code>calculate_spectrum</code>. The output <a href="#MoleculeSpectrum.Spectrum"><code>Spectrum</code></a> object is used as an input for further analysis, for example in <a href="#MoleculeSpectrum.find_transition_strengths"><code>find_transition_strengths</code></a>.</p><p>See also <a href="#MoleculeSpectrum.make_hamiltonian_parts"><code>make_hamiltonian_parts</code></a>, <a href="#MoleculeSpectrum.make_krb_hamiltonian_parts"><code>make_krb_hamiltonian_parts</code></a>, <a href="#MoleculeSpectrum.Spectrum"><code>Spectrum</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cal-miller-harvard/MoleculeSpectrum/blob/44ca798f0adbcb4a054c0d68ee3c4700e075c78c/src/MoleculeSpectrum.jl#L119-L130">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MoleculeSpectrum.get_energy" href="#MoleculeSpectrum.get_energy"><code>MoleculeSpectrum.get_energy</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">get_energy(spectrum, target)</code></pre><p>Return the energy of the eigenstate with the most wavefunction overlap with <code>target</code>.</p><p>See also <a href="#MoleculeSpectrum.calculate_spectrum"><code>calculate_spectrum</code></a>, <a href="#MoleculeSpectrum.max_overlap_with"><code>max_overlap_with</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cal-miller-harvard/MoleculeSpectrum/blob/44ca798f0adbcb4a054c0d68ee3c4700e075c78c/src/utility.jl#L162-L168">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MoleculeSpectrum.get_energy_difference" href="#MoleculeSpectrum.get_energy_difference"><code>MoleculeSpectrum.get_energy_difference</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">get_energy_difference(spectrum, g, e)</code></pre><p>Return the difference in energy between the eigenstates from <code>spectrum</code> that have the most wavefunction overlap with <code>g</code> and <code>e</code>.</p><p>This method is used to calculate transition frequencies; <code>g</code> represents the ground state, and <code>e</code> the excited state.</p><p>See also <a href="#MoleculeSpectrum.calculate_spectrum"><code>calculate_spectrum</code></a>, <a href="#MoleculeSpectrum.get_energy"><code>get_energy</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cal-miller-harvard/MoleculeSpectrum/blob/44ca798f0adbcb4a054c0d68ee3c4700e075c78c/src/utility.jl#L173-L183">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MoleculeSpectrum.find_transition_strengths" href="#MoleculeSpectrum.find_transition_strengths"><code>MoleculeSpectrum.find_transition_strengths</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">find_transition_strengths(spectrum::Spectrum, g::State, frequency_range; polarization::Union{Int, SphericalUnitVector, Nothing}=nothing)</code></pre><p>Compute electric dipole transitions out of <code>g</code> with energy between <code>frequency_range[1]</code> and <code>frequency_range[2]</code>.</p><p>The output is a <code>Vector</code> of tuples <code>(frequency, strength, closest_basis_state, eigenstate_index)</code>, produced in decreasing order of transition strength. The <code>strength</code> is the absolute value of the dipole matrix element, normalized by <span>$D/\sqrt{3}$</span> (the maximum transition dipole between <span>$N = 0$</span> and <span>$N = 1$</span>). We use the absolute value of the matrix element, rather than its square, so the results are proportional to Rabi frequency <span>$Ω$</span>.</p><p>The <code>polarization</code> keyword argument can be used to choose a specific microwave polarization. This defaults to <code>nothing</code>, which returns the incoherent sum over <span>$σ-$</span>, <span>$π$</span>, and <span>$σ+$</span>. If <code>polarization</code> is an <code>Int</code>, then it is interpreted as the spherical component <code>p = -1:1</code> of the dipole operator (<code>p == -1</code> corresponds to <span>$σ-$</span> polarization). If <code>polarization</code> is a <code>SphericalUnitVector</code>, then the polarization is interpreted as linear along that axis.</p><p>There is a convenience method <a href="#MoleculeSpectrum.plot_transition_strengths"><code>plot_transition_strengths</code></a> that immediately produces a plot from the result.</p><p>See also <a href="#MoleculeSpectrum.plot_transition_strengths"><code>plot_transition_strengths</code></a>, <a href="#MoleculeSpectrum.make_hamiltonian_parts"><code>make_hamiltonian_parts</code></a>, <a href="#MoleculeSpectrum.make_krb_hamiltonian_parts"><code>make_krb_hamiltonian_parts</code></a>, <a href="#MoleculeSpectrum.Spectrum"><code>Spectrum</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cal-miller-harvard/MoleculeSpectrum/blob/44ca798f0adbcb4a054c0d68ee3c4700e075c78c/src/MoleculeSpectrum.jl#L142-L162">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MoleculeSpectrum.plot_transition_strengths" href="#MoleculeSpectrum.plot_transition_strengths"><code>MoleculeSpectrum.plot_transition_strengths</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">plot_transition_strengths(spectrum::Spectrum, g::State, frequency_range; polarization::Union{Int, SphericalUnitVector, Nothing}=nothing)</code></pre><p>Plot the frequencies and strengths of electric dipole transitions out of <code>g</code>, with energy between <code>frequency_range[1]</code> and <code>frequency_range[2]</code>.</p><p>The <code>polarization</code> keyword argument can be used to choose a specific microwave polarization. This defaults to <code>nothing</code>, which returns the incoherent sum over <span>$σ-$</span>, <span>$π$</span>, and <span>$σ+$</span>. If <code>polarization</code> is an <code>Int</code>, then it is interpreted as the spherical component <code>p = -1:1</code> of the dipole operator (<code>p == -1</code> corresponds to <span>$σ-$</span> polarization). If <code>polarization</code> is a <code>SphericalUnitVector</code>, then the polarization is interpreted as linear along that axis.</p><p>This method calls <a href="#MoleculeSpectrum.find_transition_strengths"><code>find_transition_strengths</code></a> internally.</p><p>See also <a href="#MoleculeSpectrum.find_transition_strengths"><code>find_transition_strengths</code></a>, <a href="#MoleculeSpectrum.make_hamiltonian_parts"><code>make_hamiltonian_parts</code></a>, <a href="#MoleculeSpectrum.make_krb_hamiltonian_parts"><code>make_krb_hamiltonian_parts</code></a>, <a href="#MoleculeSpectrum.Spectrum"><code>Spectrum</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cal-miller-harvard/MoleculeSpectrum/blob/44ca798f0adbcb4a054c0d68ee3c4700e075c78c/src/MoleculeSpectrum.jl#L235-L250">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MoleculeSpectrum.calculate_dipolar_interaction" href="#MoleculeSpectrum.calculate_dipolar_interaction"><code>MoleculeSpectrum.calculate_dipolar_interaction</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">calculate_dipolar_interaction(spectrum::Spectrum, g::State, e::State; p::Int = 0)
calculate_dipolar_interaction(spectrum::Spectrum, g::Vector{ComplexF64}, e::Vector{ComplexF64}; p::Int = 0)</code></pre><p>#TODO: Document <code>calculate_dipolar_interaction</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cal-miller-harvard/MoleculeSpectrum/blob/44ca798f0adbcb4a054c0d68ee3c4700e075c78c/src/MoleculeSpectrum.jl#L273-L278">source</a></section></article><h2 id="Index"><a class="docs-heading-anchor" href="#Index">Index</a><a id="Index-1"></a><a class="docs-heading-anchor-permalink" href="#Index" title="Permalink"></a></h2><ul><li><a href="#MoleculeSpectrum.DEFAULT_FIELDS"><code>MoleculeSpectrum.DEFAULT_FIELDS</code></a></li><li><a href="#MoleculeSpectrum.DEFAULT_MOLECULAR_PARAMETERS"><code>MoleculeSpectrum.DEFAULT_MOLECULAR_PARAMETERS</code></a></li><li><a href="#MoleculeSpectrum.KRb_Nuclear_Neyenhuis"><code>MoleculeSpectrum.KRb_Nuclear_Neyenhuis</code></a></li><li><a href="#MoleculeSpectrum.KRb_Nuclear_Ospelkaus"><code>MoleculeSpectrum.KRb_Nuclear_Ospelkaus</code></a></li><li><a href="#MoleculeSpectrum.KRb_Parameters_Neyenhuis"><code>MoleculeSpectrum.KRb_Parameters_Neyenhuis</code></a></li><li><a href="#MoleculeSpectrum.KRb_Parameters_Ospelkaus"><code>MoleculeSpectrum.KRb_Parameters_Ospelkaus</code></a></li><li><a href="#MoleculeSpectrum.KRb_Polarizability"><code>MoleculeSpectrum.KRb_Polarizability</code></a></li><li><a href="#MoleculeSpectrum.KRb_Zeeman"><code>MoleculeSpectrum.KRb_Zeeman</code></a></li><li><a href="#MoleculeSpectrum.TEST_FIELDS"><code>MoleculeSpectrum.TEST_FIELDS</code></a></li><li><a href="#MoleculeSpectrum.TOY_MOLECULE_PARAMETERS"><code>MoleculeSpectrum.TOY_MOLECULE_PARAMETERS</code></a></li><li><a href="#MoleculeSpectrum.ExternalFields"><code>MoleculeSpectrum.ExternalFields</code></a></li><li><a href="#MoleculeSpectrum.HamiltonianParts"><code>MoleculeSpectrum.HamiltonianParts</code></a></li><li><a href="#MoleculeSpectrum.MolecularParameters"><code>MoleculeSpectrum.MolecularParameters</code></a></li><li><a href="#MoleculeSpectrum.NuclearParameters"><code>MoleculeSpectrum.NuclearParameters</code></a></li><li><a href="#MoleculeSpectrum.Polarizability"><code>MoleculeSpectrum.Polarizability</code></a></li><li><a href="#MoleculeSpectrum.Spectrum"><code>MoleculeSpectrum.Spectrum</code></a></li><li><a href="#MoleculeSpectrum.SphericalUnitVector"><code>MoleculeSpectrum.SphericalUnitVector</code></a></li><li><a href="#MoleculeSpectrum.SphericalVector"><code>MoleculeSpectrum.SphericalVector</code></a></li><li><a href="#MoleculeSpectrum.State"><code>MoleculeSpectrum.State</code></a></li><li><a href="#MoleculeSpectrum.ZeemanParameters"><code>MoleculeSpectrum.ZeemanParameters</code></a></li><li><a href="#MoleculeSpectrum.KRbState"><code>MoleculeSpectrum.KRbState</code></a></li><li><a href="#MoleculeSpectrum.T⁽²⁾"><code>MoleculeSpectrum.T⁽²⁾</code></a></li><li><a href="#MoleculeSpectrum.T⁽¹⁾"><code>MoleculeSpectrum.T⁽¹⁾</code></a></li><li><a href="#MoleculeSpectrum.UnitVectorX"><code>MoleculeSpectrum.UnitVectorX</code></a></li><li><a href="#MoleculeSpectrum.UnitVectorY"><code>MoleculeSpectrum.UnitVectorY</code></a></li><li><a href="#MoleculeSpectrum.UnitVectorZ"><code>MoleculeSpectrum.UnitVectorZ</code></a></li><li><a href="#MoleculeSpectrum.VectorX"><code>MoleculeSpectrum.VectorX</code></a></li><li><a href="#MoleculeSpectrum.VectorY"><code>MoleculeSpectrum.VectorY</code></a></li><li><a href="#MoleculeSpectrum.VectorZ"><code>MoleculeSpectrum.VectorZ</code></a></li><li><a href="#MoleculeSpectrum.calculate_dipolar_interaction"><code>MoleculeSpectrum.calculate_dipolar_interaction</code></a></li><li><a href="#MoleculeSpectrum.calculate_spectrum"><code>MoleculeSpectrum.calculate_spectrum</code></a></li><li><a href="#MoleculeSpectrum.decompose_to_basis_states"><code>MoleculeSpectrum.decompose_to_basis_states</code></a></li><li><a href="#MoleculeSpectrum.find_closest_basis_state"><code>MoleculeSpectrum.find_closest_basis_state</code></a></li><li><a href="#MoleculeSpectrum.find_transition_strengths"><code>MoleculeSpectrum.find_transition_strengths</code></a></li><li><a href="#MoleculeSpectrum.get_energy"><code>MoleculeSpectrum.get_energy</code></a></li><li><a href="#MoleculeSpectrum.get_energy_difference"><code>MoleculeSpectrum.get_energy_difference</code></a></li><li><a href="#MoleculeSpectrum.get_tensor_component"><code>MoleculeSpectrum.get_tensor_component</code></a></li><li><a href="#MoleculeSpectrum.hamiltonian"><code>MoleculeSpectrum.hamiltonian</code></a></li><li><a href="#MoleculeSpectrum.index_to_state"><code>MoleculeSpectrum.index_to_state</code></a></li><li><a href="#MoleculeSpectrum.make_hamiltonian_parts"><code>MoleculeSpectrum.make_hamiltonian_parts</code></a></li><li><a href="#MoleculeSpectrum.make_krb_hamiltonian_parts"><code>MoleculeSpectrum.make_krb_hamiltonian_parts</code></a></li><li><a href="#MoleculeSpectrum.max_overlap_with"><code>MoleculeSpectrum.max_overlap_with</code></a></li><li><a href="#MoleculeSpectrum.order_by_overlap_with"><code>MoleculeSpectrum.order_by_overlap_with</code></a></li><li><a href="#MoleculeSpectrum.plot_transition_strengths"><code>MoleculeSpectrum.plot_transition_strengths</code></a></li><li><a href="#MoleculeSpectrum.state_to_index"><code>MoleculeSpectrum.state_to_index</code></a></li><li><a href="#MoleculeSpectrum.tensor_dot"><code>MoleculeSpectrum.tensor_dot</code></a></li></ul></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« MoleculeSpectrum</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.14 on <span class="colophon-date" title="Saturday 5 March 2022 06:48">Saturday 5 March 2022</span>. Using Julia version 1.7.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
